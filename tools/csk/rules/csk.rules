# CSK‑M Pro v2 rules — conservative defaults
# Keep strict. Prefer sandbox_mode=workspace-write.

# Block destructive commands
prefix_rule(
  pattern = ["rm"],
  decision = "forbidden",
  justification = "Destructive. Use git revert/checkout instead."
)
prefix_rule(
  pattern = ["sudo"],
  decision = "forbidden",
  justification = "Privilege escalation is not allowed."
)
prefix_rule(
  pattern = ["powershell", "Remove-Item"],
  decision = "forbidden",
  justification = "Destructive. Use git revert/checkout instead."
)

# Read-only git commands can be prompted
prefix_rule(
  pattern = ["git", "status"],
  decision = "prompt",
  justification = "Read-only; allowed with approval."
)
prefix_rule(
  pattern = ["git", "diff"],
  decision = "prompt",
  justification = "Read-only; allowed with approval."
)

# IMPORTANT:
# Add allow rules only after validating safety and stability.
